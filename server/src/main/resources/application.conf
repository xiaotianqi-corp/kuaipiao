ktor {
    application {
        modules = [ org.xiaotianqi.kuaipiao.ApplicationKt.module ]
    }
    
    deployment {
        port = ${?API_PORT}
        port = 8080
    }
}

application {
    log_level = ${?APPLICATION_LOG_LEVEL}
    log_level = "INFO"
}

api {
    admin_key = ${?API_ADMIN_KEY}
    cookie_secure = ${?API_COOKIE_SECURE}
    cookie_secure = false
    session_max_age_seconds = ${?API_SESSION_MAX_AGE_IN_SECONDS}
    session_max_age_seconds = 86400
    api.jwt.secret = ${JWT_SECRET:your-256-bit-secret-change-in-production}
    api.jwt.issuer = kuaipiao
    api.jwt.audience = kuaipiao-api
}

postgres {
    url = ${?POSTGRES_URL}
    url = "jdbc:postgresql://127.0.0.1:5432/kuaipiao"
    user = ${?POSTGRES_USER}
    user = "postgres"
    password = ${?POSTGRES_PASSWORD}
    password = "nimda"
}

redis {
    connection_string = ${?REDIS_CONNECTION_STRING}
    connection_string = "redis://localhost:6379"
}

brevo {
    api_key = ${?BREVO_API_KEY}
    api_key = ""
    
    templates {
        email_verification = ${?BREVO_TEMPLATE_EMAIL_VERIFICATION}
        password_reset = ${?BREVO_TEMPLATE_PASSWORD_RESET}
        password_reset_success = ${?BREVO_TEMPLATE_PASSWORD_RESET_SUCCESS}
    }
    
    urls {
        email_verification_success = ${?BREVO_EMAIL_VERIFICATION_SUCCESS_URL}
        email_verification_error = ${?BREVO_EMAIL_VERIFICATION_ERROR_URL}
        email_verification = ${?BREVO_EMAIL_VERIFICATION_URL}
        reset_password = ${?BREVO_RESET_PASSWORD_URL}
    }
}

ai {
    openai {
        api_key = ${?OPENAI_API_KEY}
        api_key = ""
        base_url = ${?OPENAI_BASE_URL}
        base_url = "https://api.openai.com/v1"
        model = "gpt-4"
        timeout_ms = 2500
        max_retries = 2
    }
    
    deepseek {
        api_key = ${?DEEPSEEK_API_KEY}
        api_key = ""
        base_url = ${?DEEPSEEK_BASE_URL}
        base_url = "https://api.deepseek.com/v1"
        model = "deepseek-chat"
        timeout_ms = 3000
    }
    
    google {
        project_id = ${?GOOGLE_PROJECT_ID}
        project_id = ""
        credentials_path = ${?GOOGLE_APPLICATION_CREDENTIALS}
        credentials_path = ""
        timeout_ms = 5000
    }
    
    anthropic {
        api_key = ${?ANTHROPIC_API_KEY}
        api_key = ""
        model = "claude-3-sonnet-20240229"
        timeout_ms = 4000
    }
    
    timeouts {
        total_processing_ms = 8000
        per_provider_ms = 3000
        cache_read_ms = 500
    }
    
    cache {
        enabled = true
        ttl_hours = 24
        max_size = 10000
    }
    
    validation {
        min_confidence = 0.6
        strict_mode = false
    }
    
    features {
        ocr_enabled = true
        classification_enabled = true
        prediction_enabled = true
        compliance_enabled = true
        reconciliation_enabled = true
    }
    
    limits {
        max_file_size_mb = 10
        max_requests_per_minute = 60
        max_concurrent_requests = 5
    }
    
    monitoring {
        enabled = true
        metrics_prefix = "erp.ai"
        log_level = "INFO"
    }
}

migrations {
    auto_migrate = ${?AUTO_MIGRATE}
    auto_migrate = false
    confirm_rollback = ${?CONFIRM_ROLLBACK}
    confirm_rollback = false
}
